

## SQL 简介

### 1.1 数据库基础

-   **数据库（dataset）**

数据库是用来保存有组织的数据的容器，通常是一个文件或一组文件；

-   **表（table）**

表示某种特定类型数据的结构化清单；

-   **模式（schema）**

关于数据库和表的布局及特性的信息；

-   **列（column）**

表中的一个字段，表又一个或多个列组成；

-   **数据类型（datatype）**

所容许的数据的类型，每个表列均有响应数据类型，限制该列中所存储的数据；

-   **行（row）**

表中的一个记录；

-   **主键（primary key）**

一列（或一组列），它的值能够唯一区分表中每个行。一般来讲表中的任何列都能作为主键，只要满足如下条件：

1.  **任意两行均不具有相同的主键值；**
2.  **每行都必须具有一个主键值（不允许为 `NULL` 值）；**

### 1.2 什么是 SQL

SQL（Structured Query Language）是结构化查询语言，专门用于与数据库通信的语言；

## 2. 检索

### 2.1 检索单个列

```sql
SELECT 列名 FROM 表名;
```

**PS**：多条 SQL 语句之间要以 **分号（;）分割**；SQL 语句不区分大小写，但建议关键字使用大写，表名和列使用小写，以便调试；而且 SQL 语句中的空格都会被忽略；

### 2.2 检索多个列

```sql
SELECT 列名1,列名2,…… FROM 表名;
```

### 2.3 检索所有列

```sql
SELECT * FROm 表名;
```

### 2.4 检索不同的行

```sql
SELECT DISTINCT 列名 FROM 表名;
```

`DISTINCT` 能让指定列返回不同的值，**但不能部分使用 `DISTINCT` ，如果后面接了多个列，则只有当多个列均不同时，才能返回不同的值；**

### 2.5 限制结果

想要只返回检索结果的某一行或几行，此时可以使用 `LIMIT` 子句，而且检索出来的第一行是 `0`；

```sql
# 返回指定行
SELECT 列名 FROM 表名 LIMIT 行数;
# 返回从开始行开始的行数
SELECT 列名 FROM 表名 LIMIT 开始行 行数;
```

## 3. 排序数据

对于检索出的数据，不是随机显示的，而是以一定顺序显示，对于排序检索出的数据 **默认以升序排列（ASC）**；

### 3.1 按多个列排序

要对多个列排序，只要指定列名，列名之间用逗号分开即可；

```sql
SELECT 列名[列名2, 列名3, ……] FROM 表名 ORDER BY 列名1,列名2, ……;
```

### 3.2 指定排序方向

排序默认是升序排列（A - Z），还能指定 `DESC` 关键字来以降序排列；

**注意：** `ORDER BY` 子句的位置，应该保证它位于 `FROM` 子句之后，而如果使用 `LIMIT`，则必须位于 `ORDER BY` 之后，否则将产生错误信息；

## 4. 过滤数据

### 4.1 WHERE 子句操作符

| 操作符    | 说明               |
| --------- | ------------------ |
| `=`       | 等于               |
| `<>`      | 不等于             |
| `!=`      | 不等于             |
| `<`       | 小于               |
| `<=`      | 小于等于           |
| `>`       | 大于               |
| `>=`      | 大于等于           |
| `BETWEEN` | 在指定的两个值之间 |

**注意：** 同时使用 `ORDER BY` 和 `WHERE` 子句时，应该让 `ORDER BY` 位于 `WHERE` 之后，否则将产生错误；

### 4.2 空值检查

设计表时，可以指定其中的列是否可以不包含值，如果不包含值时，则称其为包含空值 `NULL`。

`NULL` 表示无值（no value），与字段包含 `0`、空字符串或仅包含空格不同；

### 4.3 操作符

操作符（operator）是用来联结或改变 `WHERE` 子句的关键字，也叫作 **逻辑操作符**；

1.  **AND 操作符**

通过 `AND` 给 `WHERE` 添加附加条件，实现对多个列的过滤，用来指示检索满足所有给定条件的行；

```sql
SELECT 列1，列2，…… FROM 表名 WHERE 条件1 AND 条件2;
```

2.  **OR 操作符**

指示检索匹配任一条件的行；

```sql
SELECT 列1，列2，…… FROM 表名 WHERE 条件1 OR 条件2;
```

3.  **AND & OR 优先级**

SQL 语言中，优先处理 `AND` 操作符，然后再处理 `OR` 操作符，为了避免优先级带来的困扰，推荐使用圆括号来明确分组相应的操作符；

4.  **IN 操作符**

`IN` 用于指定条件范围，范围中的每个条件都能进行匹配，`IN` 取合法值的由逗号分隔的清单，均括在圆括号中；

```sql
SELECT 列1，列2，…… FROM 表名 WHERE 列名 IN （条件1，条件2，……） ORDER BY 列名;
```

`IN` 操作符的优点：

-   使用长的合法选项清单时，`IN` 操作符的语法更清晰直观；
-   使用 `IN` 时，计算的次序更容易管理；
-   `IN` 操作符一般比 `OR` 操作符清单执行更快；
-   `IN` 的最大优点是可以包含其他 `SELECT` 语句，能更动态地创建 `WHERE` 子句；

5.  **NOT 操作符**

`WHERE` 子句中的 `NOT` 操作符的唯一功能就是 **否定它之后跟的任何条件**；

**注意：** MySQL 仅支持使用 `NOT` 对 `IN、BETWEEN、EXISTS` 子句取反；

```sql
SELECT 列1，列2，…… FROM 表名 WHERE 列名 NOT 条件 ORDER BY 列名;
```

### 4.4 通配符过滤

1.  **通配符（wildcard）**：用于匹配值的一部分的特殊字符；
2.  **搜索模式（search pattern）**：由字面值、通配符或两者组合构成的搜索条件；
3.  **百分号（%）通配符**：`%` 表示任何字符出现任意次数；
4.  **下划线（_）通配符**：`_` 只匹配单个字符而非多个字符；

```java
SELECT * FROM 表名 WHERE 列名 LIKE '村雨遥%';
SELECT * FROM 表名 WHERE 列名 LIKE '村雨遥_';
```




