---
title: 约束
isOriginal: true
icon: mysql
order: 20
category:
  - MySQL 教程
date: 2022-03-05
---
作者：村雨遥

博客：[JavaPark](https://cunyu1943.github.io/JavaPark)

>   吾生也有涯，而知也无涯。

## 概述

所谓约束，就是作用于表中字段上的规则，用来限制存储在表中的数据。使用的目的是为了保证数据库中数据的正确性、有效性以及完整性。

约束有很多种，常见的约束分类如下表。

| 关键字        | 约束                        | 描述                                                         |
| ------------- | --------------------------- | ------------------------------------------------------------ |
| `NOT NULL`    | 非空约束                    | 限制该字段的数据不能为 `null`                                |
| `UNIQUE`      | 唯一约束                    | 保证该字段的所有数据都是唯一不重复的                         |
| `PRIMARY KEY` | 主键约束                    | 主键是一行数据的唯一标识，要求非空且唯一                     |
| `DEFAULT`     | 默认约束                    | 保存数据时，若未指定该字段的值，则采用默认值                 |
| `CHECK`       | 检查约束（8.0.16 版本之后） | 保证字段值满足某一个条件                                     |
| `FOREIGN KEY` | 外键约束                    | 用于让两张表之间的数据建立连接，从而保证数据的一致性和完整性 |

## 外键约束

所谓外键约束，就是让两张表之间的数据建立连接，从而保证数据的一致性和完整性。

### 创建/删除约束

添加外键的方式主要有两种，一种是在创建表时添加，而另一种则是在创建表之后添加。

1.   **创建时**

```sql
CREATE TABLE 表名(
	字段名 数据类型,
    ……
    [CONSTRAINT] [外键名] FOREIGN KEY(外键字段名) REFERENCES 主表(主表列名)
);
```

2.   **创建后**

```sql
ALTER TABLE 表名 ADD CONSTRAINT 外键名称 FOREIGN KEY(外键字段名) REFERENCES 主表(主表列名);
```

既然添加了外键，那当然就有对应删除外键的方式。

```sql
ALTER TABLE 表名 DROP FOREIGN KEY 外键名称;
```

### 删除/更新行为

| 行为          | 说明                                                                                                             |
| ------------- | ---------------------------------------------------------------------------------------------------------------- |
| `NO ACTION`   | 主表中删除/更新对应记录时，先检查该记录是否有对应外键，若有则不允许删除/更新（与 `RESTRICT` 一致）               |
| `RESTRICT`    | 主表中删除/更新对应记录时，先检查该记录是否有对应外键，若有则不允许删除/更新（与 `NO ACTION` 一致）              |
| `CASCADE`     | 主表中删除/更新对应记录时，先检查该记录是否有对应外键，若有则删除/更新外键在从表中的记录                         |
| `SET NULL`    | 当在主表中删除对应记录时，先检查该记录是否有对应外键，若有则设置从表中该外键值为 `NULL`（要求外键可以取 `NULL`） |
| `SET DEFAULT` | 主表有变更时，从表将外键列设置为一个默认值（`Innodb` 不支持）                                                    |

```sql
ALTER TABLE 表名 ADD CONSTRAINT 外键名称 FOREIGN KEY (外键字段) REFERENCES 主表名(主表字段名) ON UPDATE CASCADE ON DELETE CASCADE;
```

